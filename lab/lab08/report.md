# CS302 OS Lab08 - Report

Name: 刘仁杰
SID: 11911808

## Answers

### 1.**一个进程有多少个mm_struct? mm_struct的作用是什么？**

1. 一个进程只有一个mm_struct。
1. mm_struct把一个页表包含的多个vma_struct , 也就是多个访问权限可能不同的，不相交的连续地址区间的信息组合起来，包括vma_struct 链表的首指针，对应的页表在内存里的指针， vma_struct 链表的元素个数。

### 2.**vma_struct的作用是什么？**

vma_struct描述一段连续的虚拟地址，从 vm_start 到 vm_end 。 通过包含一个 list_entry_t 成员，同一个页表对应的多个 vma_struct 结构体串成一个链表，在链表里它们按照区间的起始点排序。同时在结构体内用vm_flags表示一段虚拟地址对应的权限（可读，可写，可执 行等）。

### 3.什么情况下会出触发缺页中断？

程序可以访问"不对应物理内存页帧的虚拟内存地址"，即mmu找不到pte对应的物理内存页，这时CPU应当抛出 Page Fault 这个异常。

### 4.major page fault是如何处理的？在实验代码中对应哪一段？

1. 访问的虚拟地址内容不在内存中，需要从外设载入，建立映射。必要时使用页面替换算法替换掉其他的物理页面。
2. 实现代码对应片段：



### 5.swap_in和swap_out分别发生在什么时候？（选做，建议做）

1. swap_in发生在major page fault的时候，需要把page从外设交换区load进内存。
2. 在从外设交换区换入page的时候，如果内存页已被占满，则swap_out会被调用，将根据替换算法找到要被换出的那一个page，将其放到外部存储的一个位置，同时修改该页对应的页表项，最后把该页释放以换入需要的页。