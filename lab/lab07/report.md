# CS302 OS Lab07 - Report

Name: 刘仁杰
SID: 11911808

## Answers

### 1.**请参照Sv32的地址转换过程，写出Sv39的转换过程**

1. satp.PPN给出了一级页表的基址，VA[38:30]给出了一级页号，因此处理器会读取位于地址(satp.PPN * 4096 + VA[38:30] * 8)的页表项
2. 该PTE包含了二级页表的基址，VA[29:21]给出了二级页号，因此处理器读取位于地址(PTE.PPN * 4096 + VA[29:21] * 8)的页表项
3. 该PTE包含了三级页表的基址，VA[20:12]给出了三级页号，因此处理器读取位于地址(PTE.PPN * 4096 + VA[20:12] * 8)的页表项
4. 叶节点页表项的PPN字段和页内偏移([11:0])组成了最终结果：物理地址就是(LeafPTE.PPN * 4096 + VA[11:0])

### 2.**一个巨页的大小是多少，如何计算得出巨页的大小？**

巨页大小：$2^{21} \ Bytes=2 \ MBytes$.

### 3.一个4GB的内存空间使用下图所示的二级页表，页面大小为4KB。一个需要在高虚拟地址空间，中虚拟地址空间，和低虚拟地址空间分别使用4MB的连续空间的进程至少需要多大的页表空间？

二级页表中，第二级页号VPN[0]为10个bit，因此可以表示$2^{10}$个不同的页面，每个页面大小为4KB，故一个二级页表可以指向$2^{10}$×4KB=4MB的物理空间。第一级页号VPN[1]同样为10个bit可以指向$2^{10}$个不同的二级页表，因此图中的二级页表机制可以指向$2^{10}$×4MB=4GB的物理空间。一个进程需要使用高虚拟地址空间，中虚拟地址空间，和低虚拟地址空间分别使用4MB的连续空间，即$2^{10}$个页，总共三个二级页表。那么，我们首先需要预留三个第二级页表。除此之外我们还需要一个第一级页表存储这三个二级页表的PTE。

所以总页表空间大小为：$(1+3) \times $PTE_size$ \times 2^{10}$ = $2^{12} \times$PTE_size